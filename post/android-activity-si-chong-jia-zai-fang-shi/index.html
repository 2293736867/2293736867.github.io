
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>Android Activity四种加载方式 | 氷泠&#39;s blog</title>
<meta name="description" content="我配不上你，
纵然很努力。">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://2293736867.github.io/favicon.ico?v=1615371949211">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://2293736867.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://2293736867.github.io">
        <img class="avatar" src="https://2293736867.github.io/images/avatar.png?v=1615371949211" alt="" width="32px" height="32px">
      </a>
      <a href="https://2293736867.github.io">
        <h1 class="site-title">氷泠&#39;s blog</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://2293736867.github.io/post-images/android-activity-si-chong-jia-zai-fang-shi.jpg')">
            </div>
          
          <h2 class="post-title">Android Activity四种加载方式</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2020-06-03</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://2293736867.github.io/tag/vBuId7yVdn/">
                    Android
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <p><ul class="markdownIt-TOC">
<li><a href="#1-%E6%A6%82%E8%BF%B0">1 概述</a></li>
<li><a href="#2-standard">2 standard</a></li>
<li><a href="#3-singletop">3 singleTop</a></li>
<li><a href="#4-singletask">4 singleTask</a></li>
<li><a href="#5-singleinstance">5 singleInstance</a></li>
<li><a href="#6-%E6%80%BB%E7%BB%93">6 总结</a></li>
</ul>
</p>
<h1 id="1-概述">1 概述</h1>
<p>Android中的Activity共有四种加载方式,可以在AndroidManifest.xml中对应的activity的android:launchMode中指定,四种方式如下:</p>
<ul>
<li>standrad</li>
<li>singleTop</li>
<li>singleTask</li>
<li>singleInstance</li>
</ul>
<p>其中,standard是默认的加载方式,singleTop是栈顶单例模式,singleTask是Task内单例模式,singleInstance是全局单例模式,下面一一进行说明.</p>
<h1 id="2-standard">2 standard</h1>
<p>standard是默认模式,每次通过这种模式启动时,都会为Activity创建一个新的实例,并将这个新的实例添加到栈顶,每次按返回键就会一直出栈,处于栈顶的实例就算用户看到的界面.<br>
下面测试一下,新建一个Activity与一个Intent,加上一个Button与startActivity:<br>
<img src="https://img-blog.csdnimg.cn/20200325153544344.png" alt="在这里插入图片描述" loading="lazy"><br>
加上调试信息以及设置好logcat过滤后,测试:<br>
<img src="https://img-blog.csdnimg.cn/20200325153525366.gif" alt="在这里插入图片描述" loading="lazy"><br>
可以看到每次点击按钮都是一个新的实例,置于Task栈顶,示意图如下:<br>
<img src="https://img-blog.csdnimg.cn/20200325163431369.png" alt="在这里插入图片描述" loading="lazy"><br>
然后,每次返回,栈顶的Activity出栈,直到栈为空.</p>
<h1 id="3-singletop">3 singleTop</h1>
<p>singleTop允许一个Activity实例化多个对象,与standard唯一的不同就算,当将要启动的Activity位于栈顶时,不会创建新的实例,而是直接复用已有实例.<br>
另外,如果要启动的Activity没有位于栈顶,系统会创建新的实例,并加载到栈顶.<br>
下面使用两个Activity测试一下,增加一个按钮和事件绑定,同时修改AndroidManifest.xml的android:launchMode为singleTop:<br>
<img src="https://img-blog.csdnimg.cn/20200325160043559.png" alt="在这里插入图片描述" loading="lazy"><br>
这里FirstActivity用的是singleTop,SecondActivity是standard.<br>
<img src="https://img-blog.csdnimg.cn/20200325160507198.gif" alt="在这里插入图片描述" loading="lazy"><br>
一开始点击First Activity没反应,因为此时First Activity位于栈顶,然后点击了两次Second,创建了两个Second Activity实例,然后再次点击First,此时FirstActivity没有位于栈顶,因此新建First Activity的实例并放置于栈顶,此时栈示意图如下:<br>
<img src="https://img-blog.csdnimg.cn/20200325161055773.png" alt="在这里插入图片描述" loading="lazy"><br>
然后点击返回依次退栈.</p>
<h1 id="4-singletask">4 singleTask</h1>
<p>singleTask表示同一个Task内只有一个实例,当准备实例一个Activitty时,会查看栈中有没有这个Activity的实例对象,如果不存在,就创建一个实例,并放置于栈顶,如果已存在,则会移除此实例上面的所有实例移出栈,使目标实例位于栈顶.<br>
下面来测试一下,修改FirstActivity的launchMode为singleTask,SecondActivity不变:<br>
<img src="https://img-blog.csdnimg.cn/20200325161622450.png" alt="在这里插入图片描述" loading="lazy"><br>
<img src="https://img-blog.csdnimg.cn/20200325161828279.gif" alt="在这里插入图片描述" loading="lazy"><br>
首先进入First Activity,然后开启了四个Second Activity,此时的栈如下:<br>
<img src="https://img-blog.csdnimg.cn/2020032516194389.png" alt="在这里插入图片描述" loading="lazy"><br>
然后点击First的按钮后,上面的四个Second Activity全部出栈:<br>
<img src="https://img-blog.csdnimg.cn/20200325162034501.png" alt="在这里插入图片描述" loading="lazy"><br>
因此上面的图会看到连续有四个destroy.</p>
<h1 id="5-singleinstance">5 singleInstance</h1>
<p>singleInstance是会使用一个全新的Task栈来存放该Activity实例,也就是说,Activity独占一个Task栈.下面把First Activity改成singleInstance,Second Activity不变:<br>
<img src="https://img-blog.csdnimg.cn/20200325162436667.png" alt="在这里插入图片描述" loading="lazy"><br>
<img src="https://img-blog.csdnimg.cn/2020032516293015.gif" alt="在这里插入图片描述" loading="lazy"><br>
一开始在Task id为587的Task栈创建First Activity的一个实例,然后在Task id为588的Task栈创建了三个Second Activity实例,示意图如下:<br>
<img src="https://img-blog.csdnimg.cn/20200325163131567.png" alt="在这里插入图片描述" loading="lazy"><br>
退栈时,首先在当前Activity所在的Task栈进行退栈操作,而不是按照进栈的顺序进行退栈,即先把当前Task出栈完成,再出栈其他Task.因此会先出栈First Activity,然后再出栈三个Second Activity.</p>
<h1 id="6-总结">6 总结</h1>
<p>一个表总结:</p>
<table>
<thead>
<tr>
<th>操作顺序</th>
<th>standard</th>
<th>singleTop</th>
<th>singleTask</th>
<th>singleInstance</th>
</tr>
</thead>
<tbody>
<tr>
<td>初始状态</td>
<td><img src="https://img-blog.csdnimg.cn/20200325163929785.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325163933219.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325163938938.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325163942273.png" alt="在这里插入图片描述" loading="lazy"></td>
</tr>
<tr>
<td>First-&gt;First</td>
<td><img src="https://img-blog.csdnimg.cn/20200325164018803.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325163938938.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325163938938.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325163938938.png" alt="在这里插入图片描述" loading="lazy"></td>
</tr>
<tr>
<td>First-&gt;Second</td>
<td><img src="https://img-blog.csdnimg.cn/20200325164129134.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325164204565.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325164207274.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325164228508.png" alt="在这里插入图片描述" loading="lazy"></td>
</tr>
<tr>
<td>Second-&gt;First</td>
<td><img src="https://img-blog.csdnimg.cn/20200325164403423.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325164435477.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325164458969.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325164228508.png" alt="在这里插入图片描述" loading="lazy"></td>
</tr>
<tr>
<td>First-&gt;Second</td>
<td><img src="https://img-blog.csdnimg.cn/20200325165254101.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325165201605.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325165342542.png" alt="在这里插入图片描述" loading="lazy"></td>
<td><img src="https://img-blog.csdnimg.cn/20200325165403627.png" alt="在这里插入图片描述" loading="lazy"></td>
</tr>
</tbody>
</table>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://2293736867.github.io/post/mysql8-kai-qi-ssl-jia-mi/">
              <h3 class="post-title">
                下一篇：MySQL8开启ssl加密
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">我配不上你，
纵然很努力。</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://2293736867.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
