
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>每天AC系列(十三):两数相除 | 氷泠&#39;s blog</title>
<meta name="description" content="我配不上你，
纵然很努力。">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://2293736867.github.io/favicon.ico?v=1615370942909">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://2293736867.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://2293736867.github.io">
        <img class="avatar" src="https://2293736867.github.io/images/avatar.png?v=1615370942909" alt="" width="32px" height="32px">
      </a>
      <a href="https://2293736867.github.io">
        <h1 class="site-title">氷泠&#39;s blog</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://2293736867.github.io/post-images/mei-tian-ac-xi-lie-shi-san-liang-shu-xiang-chu.jpg')">
            </div>
          
          <h2 class="post-title">每天AC系列(十三):两数相除</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2020-06-03</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://2293736867.github.io/tag/DZ5E1trvJ/">
                    AC
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <h1 id="1-题目">1 题目</h1>
<p><a href="https://leetcode-cn.com/problems/divide-two-integers/submissions/">LeetCode第29题</a>,计算两数相除的商，不允许使用乘法，除法，求模运算符。<br>
<img src="https://img-blog.csdnimg.cn/20200204112912258.png" alt="在这里插入图片描述" loading="lazy"></p>
<h1 id="2-减法">2 减法</h1>
<p>首先判断结果是否需要加上负号，将商置为0后，被除数不断减去除数，同时商自增。最后根据是否有负号返回相应的商。</p>
<pre><code class="language-java">boolean negative = true;
if((dividend &gt; 0 &amp;&amp; divisor &gt; 0) || (dividend &lt; 0 &amp;&amp; divisor &lt; 0))
    negative = false;
dividend = dividend &gt; 0 ? dividend : -dividend;
divisor = divisor &gt; 0 ? divisor : -divisor;
int result = 0;
while(dividend &gt;= divisor)
{
    dividend -= divisor;
    ++result;
}
return negative ? -result : result;
</code></pre>
<h1 id="3-思考">3 思考</h1>
<h2 id="31-溢出">3.1 溢出</h2>
<p><img src="https://img-blog.csdnimg.cn/20200205141649200.png" alt="在这里插入图片描述" loading="lazy"><br>
-2147483648与2147483647这两个数，是4字节的int的最小值与最大值，在java中，它们可用Integer.MIN_VALUE与Integer.MAX_VALUE表示，当一个int为Integer.MIN_VALUE时，取反也是这个数：<br>
<img src="https://img-blog.csdnimg.cn/20200205143206762.png" alt="在这里插入图片描述" loading="lazy"><br>
<img src="https://img-blog.csdnimg.cn/20200205143314662.png" alt="在这里插入图片描述" loading="lazy"><br>
最简单最粗暴的解决方案就是使用long，long可以放下-Integer.MIN_VALUE，因此，直接将被除数与除数的类型改成long，返回值转为long即可。<br>
但是提交了一下，超时：<br>
<img src="https://img-blog.csdnimg.cn/20200205143737940.png" alt="在这里插入图片描述" loading="lazy"><br>
所以对除数1与-1进行特判一下：</p>
<pre><code class="language-java">if(divisor == 1)
	return dividend;
if(divisor == -1)
{
   	if(dividend == Integer.MIN_VALUE) return Integer.MAX_VALUE;
   	return -dividend;
}
</code></pre>
<p>若除数是1直接返回被除数，这时不需要考虑溢出，若是除数是-1，需要特判一下被除数是否为int的最小值，因为-Intger.MIN_VALUE也是Intger.MIN_VALUE，题目也说了返回int的最大值。<br>
然后信心十足地提交了：<br>
<img src="https://img-blog.csdnimg.cn/20200205144348338.png" alt="在这里插入图片描述" loading="lazy"><br>
惨淡。</p>
<h2 id="32-负数">3.2 负数</h2>
<p>溢出的原因，就算因为负数的存储范围比正数多1，就算因为那两个可恶的-2147483648与2147483647.<br>
上面的做法是判断结果的负号，然后将被除数与除数都转为正数来计算，可以换一种思路，将被除数与除数都转为负数来计算：</p>
<pre><code class="language-java">dividend = dividend &gt; 0 ? -dividend : dividend;
divisor = divisor &gt; 0 ? -divisor : divisor;
int result = 0;
while(dividend &lt;= divisor)
{
    dividend -= divisor;
    ++result;
}
if(negative)
{
    if(-result == Integer.MIN_VALUE)
        return Integer.MIN_VALUE;
    return -result;
}
else
{
    if(result == Integer.MIN_VALUE)
        return Integer.MAX_VALUE;
    return result;
}
</code></pre>
<p>结果从0开始自增，while循环的条件改成被除数小于等于除数而不是之前的被除数大于等于除数，然后对得出的商判断正负与边界，如果是负数，判断商的相反数是否是int的最小值，若是的话，表示真正的商为2147483648，负溢出，返回int的最小值，若不是负数，判断商是否为int的最小值，若是的话，表示真正的商为2147483648，正溢出，返回int的最大值。<br>
<img src="https://img-blog.csdnimg.cn/20200205151724992.png" alt="在这里插入图片描述" loading="lazy"><br>
快了600ms，还是有效果的。</p>
<h2 id="33-翻倍与移位">3.3 翻倍与移位</h2>
<p>速度慢的原因，是因为减法。因此需要改进减法，使被除数更快地逼近除数。<br>
对于被除数为2147483647，除数为1的情况，需要减2147483647次，才能得出结果，所以，使用翻倍，第一次减1，第二次减2，第三次减4，以此类推。<br>
但是怎么翻倍怎么操作呢?</p>
<pre><code class="language-java">a *= 2 ?
</code></pre>
<p>题目说不能用乘法运算符。<br>
作为一个现代的程序员，总不能这样翻倍吧？</p>
<pre><code class="language-java">a += a;
</code></pre>
<p>这时就轮到位移运算符登场了，左移一位，相当于乘2，右移一位相当与除2：</p>
<pre><code class="language-java">a &lt;&lt;= 1; // a *= 2
a &gt;&gt;= 1; // a /= 2
</code></pre>
<p>总体思路是设置一个tempResult与一个tempDivisor，不断将tempResult与tempDivisor翻倍，直到被除数大于等于tempDivisor或tempDivisor溢出，然后把tempResult增加到result上面。</p>
<pre><code class="language-java">while(dividend &lt;= divisor)
{
    int tempDivisor = divisor;
    int tempResult = 1;
    while(dividend &lt; (tempDivisor&lt;&lt;1) &amp;&amp; tempDivisor &gt; (Integer.MIN_VALUE &gt;&gt; 1))
    {
        tempDivisor &lt;&lt;= 1;
        tempResult &lt;&lt;= 1;
    }
    dividend -= tempDivisor;
    result += tempResult;
}
</code></pre>
<p>其中：</p>
<pre><code class="language-java">tempDivisor &gt; (Integer.MIN_VALUE &gt;&gt; 1)
</code></pre>
<p>这个while中的判断很重要，如果tempDivisor大于int的最小值的一半，则tempDivisor左移1位后会小于Integer.MIN_VALUE，也就是小于int的最小值，会溢出，跳出循环后会导致被除数减去一个正数而不是一个负数，这样相当于增大了被除数导致计算的结果错误。<br>
<img src="https://img-blog.csdnimg.cn/20200205210343174.png" alt="在这里插入图片描述" loading="lazy"></p>
<h1 id="4-递归">4 递归</h1>
<p>递归可以减少设置一个result变量，直接在返回值里加上即可：</p>
<pre><code class="language-java">public int div(int dividend,int divisor)
{
    if(dividend &lt;= divisor)
    {
        int tempDivisor = divisor;
        int tempResult = 1;
        while(dividend &lt; (tempDivisor&lt;&lt;1) &amp;&amp; tempDivisor &gt; (Integer.MIN_VALUE &gt;&gt; 1))
        {
            tempDivisor &lt;&lt;= 1;
            tempResult &lt;&lt;= 1;
        }
        return tempResult + div(dividend-tempDivisor,divisor);
    }
    return 0;
}
</code></pre>
<p>代码与迭代基本相同，结束条件为被除数大于除数，在进入递归前需要对被除数与除数处理正负：</p>
<pre><code class="language-java">public int divide(int dividend,int divisor)
{
    boolean negative = (dividend &gt; 0) ^ (divisor &gt; 0);
    int result = div(dividend &gt; 0 ? -dividend : dividend,divisor &gt; 0 ? -divisor : divisor);
    if(negative) return -result;
    return result == Integer.MIN_VALUE ? Integer.MAX_VALUE : result;
}
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://img-blog.csdnimg.cn/20200205212620767.png" alt="在这里插入图片描述" loading="lazy"></figure>
<h1 id="5-源码">5 源码</h1>
<p><a href="https://github.com/2293736867/ACEveryDay/tree/master/Day13">github</a></p>
<p><a href="https://gitee.com/imykr/ACEveryDay/tree/master/Day13">码云</a></p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://2293736867.github.io/post/mei-tian-ac-xi-lie-shi-er-k-ge-yi-zu-fan-zhuan-lian-biao/">
              <h3 class="post-title">
                下一篇：每天AC系列(十二):K个一组翻转链表
              </h3>
            </a>
          </div>
          
      </div>

      
        
          <div id="gitalk-container"></div>
        

        
      

      <div class="site-footer">
  <div class="slogan">我配不上你，
纵然很努力。</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://2293736867.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '477bf133e6f4f92e3d3d',
        clientSecret: 'c917fc4292d22d69e98b9521ac1e6fca627fe54c',
        repo: '2293736867.github.io',
        owner: '2293736867',
        admin: ['2293736867'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
