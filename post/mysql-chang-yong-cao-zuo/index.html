
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>MySQL 常用操作 | 氷泠&#39;s blog</title>
<meta name="description" content="我配不上你，
纵然很努力。">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://2293736867.github.io/favicon.ico?v=1615371949211">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://2293736867.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://2293736867.github.io">
        <img class="avatar" src="https://2293736867.github.io/images/avatar.png?v=1615371949211" alt="" width="32px" height="32px">
      </a>
      <a href="https://2293736867.github.io">
        <h1 class="site-title">氷泠&#39;s blog</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://2293736867.github.io/post-images/mysql-chang-yong-cao-zuo.jpg')">
            </div>
          
          <h2 class="post-title">MySQL 常用操作</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2020-07-06</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://2293736867.github.io/tag/zMdXcdRde/">
                    MySQL
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <h1 id="1-创建打开删除数据库">1 创建/打开/删除数据库</h1>
<pre><code class="language-sql">create database db;
create database db character set utf8mb4;
use db;
drop database db;
alter database db character set utf8mb4;
</code></pre>
<h1 id="2-修复表">2 修复表</h1>
<pre><code class="language-sql">mysqlcheck --all-databases
mysqlcheck --all-databases --fast
</code></pre>
<h1 id="3-查询">3 查询</h1>
<pre><code class="language-sql">select * from table1;
select * from table1,table2;
select field1,field2,... from table1,table2;

select ... from ... where condition;
select ... from ... where condition group by field;
select ... from ... where condition1 group by field having condition2;
select ... from ... where condition order by field;
select ... from ... where condition order by field1,field2 desc;
select ... from ... where condition limit 10;

select distinct field1,field2 from ...
select distinct table1.field1,table2.field2 from table1,table2 where condition1 group by field4 having condition2 order by field3 desc limit 20;
</code></pre>
<h1 id="4-插入删除更新数据">4 插入/删除/更新数据</h1>
<pre><code class="language-sql"># 插入
insert into table1(field1,field2,...) values(value1,value2,...);

# 删除
delete from table1;
truncate from table1;
delete from table1 where condition;
delete table1,table2 from table1,table2 where condition;

# 更新
update table1 set field=new_value where condition;
update table1,table2 set field1=new_value1,field2=new_value2,... where table1.id=table2.id and condition;
</code></pre>
<h1 id="5-创建删除修改表">5 创建/删除/修改表</h1>
<pre><code class="language-sql"># 创建
create table table1(field1 type,field2 type,...);
create table table1(field type,...,index(field));
create table table1(field type,...,primary key(field));
create table table1(field1 type,field2 type,...,primary key(field1,field2));
create table table1(field type,...,foreign key(field) references table2(field));
create table table1(field1 type,field2 type,...foreign key(field1,field2) references table2(field1,field2));
create table if not exists table1(field type,...);
create temporary table table1(field type,...);

# 删除
drop table table1;
drop table if exists table1;
drop table table1,table2;

# 修改
alter table table1 modify old_name new_type;
alter table table1 modify old_name new_type not null;
alter table table1 change old_name new_name new_type;
alter table table1 change old_name new_name new_type not null;
alter table table1 alter field set default ...;
alter table table1 alter field drop default;
alter table table1 add new_name new_type;
alter table table1 add new_name new_type first;
alter table table1 add new_name new_type after field;
alter table table1 drop field;
alter table table1 add index(field);

# 改变字段顺序
alter table table1 modify field type first;
alter table table1 modify field1 type after field2;
alter table table1 change old_name new_name new_type first;
alter table table1 change old_name new_name new_type after field;
</code></pre>
<h1 id="6-重置root密码">6 重置root密码</h1>
<pre><code class="language-sql"># 停止服务，各个机器具体不一样，可以使用图形界面停止
systemctl stop mysqld
mysqld_safe --skip-grant-tables
# 若失败可以尝试
# mysqld_sage --shared-memory --skip-grant-tables

# 另一个终端
mysql
# 进入之后
</code></pre>
<pre><code class="language-sql"># MySQL 8+
flush privileges;
alter user 'root'@'localhost' identified by 'new_pass';
</code></pre>
<pre><code class="language-sql"># MySQL 旧版
update mysql.user set password=password('new_password') where user='root';
</code></pre>
<h1 id="7-备份与恢复">7 备份与恢复</h1>
<pre><code class="language-sql"># 备份
mysqldump -u username -p dbname &gt; backup.sql

# 恢复
mysql -u username -p dbname &lt; backup.sql
</code></pre>
<h1 id="8-浏览">8 浏览</h1>
<pre><code class="language-sql">show databases;
show tables;
show fields from table1;
describe table1;
show create table table1;
show processlist;
</code></pre>
<h1 id="9-连接查询">9 连接查询</h1>
<pre><code class="language-sql">select ... from t1 join t2 on t1.id = t2.id where condition;
select ... from t1 left/right join t2 on t1.id = t2.id where condition;
select ... from t1 join (t2 join t3 on ...) on ...;
</code></pre>
<h1 id="10-条件">10 条件</h1>
<pre><code class="language-sql">field = value
field &lt;&gt; value
field like 'value%'
filed is null
field is not null
field in (value1,value2,...)
field not in (value1,value2,...)
condition1 and conditoin2
condition1 or condition2
</code></pre>
<h1 id="11-用户与权限">11 用户与权限</h1>
<pre><code class="language-java">grant all privileges on database.table to 'user'@'localhost' identified by 'password';
grant select,insert,delete on database.* to 'user'@'xxx.xxx.xxx.xxx' identified by 'password';

revoke select on database.table from 'user'@'host';
revoke all privileges,grant option from 'user'@'host';

alter user 'user'@'host' identified with mysql_native_password by 'new_password';

drop user 'user'@'host';
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://2293736867.github.io/post/mei-ri-fen-xiang-di-17-qi/">
              <h3 class="post-title">
                下一篇：每日分享 第17期
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">我配不上你，
纵然很努力。</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://2293736867.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
