
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>真 ● 禁秘技 ● 奥义 ● 终端美化（改） | 氷泠&#39;s blog</title>
<meta name="description" content="我配不上你，
纵然很努力。">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://2293736867.github.io/favicon.ico?v=1615370942909">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://2293736867.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://2293736867.github.io">
        <img class="avatar" src="https://2293736867.github.io/images/avatar.png?v=1615370942909" alt="" width="32px" height="32px">
      </a>
      <a href="https://2293736867.github.io">
        <h1 class="site-title">氷泠&#39;s blog</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://2293736867.github.io/post-images/zhen-jin-mi-ji-ao-yi-zhong-duan-mei-hua-gai.jpg')">
            </div>
          
          <h2 class="post-title">真 ● 禁秘技 ● 奥义 ● 终端美化（改）</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2020-10-24</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://2293736867.github.io/tag/FaFerPQym/">
                    终端美化
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <p><ul class="markdownIt-TOC">
<li><a href="#1-%E6%A6%82%E8%BF%B0">1 概述</a></li>
<li><a href="#2-%E7%8E%AF%E5%A2%83">2 环境</a></li>
<li><a href="#3-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">3 准备工作</a>
<ul>
<li><a href="#31-zsh">3.1 <code>zsh</code></a></li>
<li><a href="#32-zinitoh-my-zsh">3.2 <code>zinit</code>/<code>oh-my-zsh</code></a>
<ul>
<li><a href="#321-zinit">3.2.1 <code>zinit</code></a></li>
<li><a href="#322-omz">3.2.2 <code>OMZ</code></a></li>
</ul>
</li>
<li><a href="#33-%E5%AD%97%E4%BD%93">3.3 字体</a></li>
</ul>
</li>
<li><a href="#4-p10k%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE">4 <code>p10k</code>基本配置</a></li>
<li><a href="#5-p10k%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE">5 <code>p10k</code>自定义配置</a>
<ul>
<li><a href="#51-%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">5.1 如何修改配置文件？</a></li>
<li><a href="#52-%E6%8F%90%E7%A4%BA%E6%AE%B5">5.2 提示段</a>
<ul>
<li><a href="#521-%E5%BC%80%E5%90%AF%E5%85%B3%E9%97%AD%E6%95%B4%E4%B8%AA%E6%8F%90%E7%A4%BA%E6%AE%B5">5.2.1 开启/关闭整个提示段</a></li>
<li><a href="#522-%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3">5.2.2 系统相关</a></li>
<li><a href="#523-%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3">5.2.3 语言相关</a></li>
<li><a href="#524-%E4%BA%91%E7%9B%B8%E5%85%B3">5.2.4 云相关</a></li>
<li><a href="#525-%E5%85%B6%E4%BB%96">5.2.5 其他</a></li>
</ul>
</li>
<li><a href="#53-%E9%A2%9C%E8%89%B2">5.3 颜色</a></li>
<li><a href="#54-%E4%BD%8D%E7%BD%AE">5.4 位置</a></li>
<li><a href="#55-%E5%9B%BE%E6%A0%87">5.5 图标</a></li>
</ul>
</li>
<li><a href="#6-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">6 配置文件</a></li>
<li><a href="#7-%E6%9D%82%E9%A1%B9">7 杂项</a>
<ul>
<li><a href="#71-%E6%96%87%E7%AB%A0%E6%9B%B4%E6%96%B0">7.1 文章更新</a></li>
<li><a href="#72-%E5%85%B3%E4%BA%8Ep9k">7.2 关于<code>p9k</code></a></li>
<li><a href="#73-%E6%8F%90%E7%A4%BA%E5%BB%B6%E8%BF%9F">7.3 提示延迟</a></li>
<li><a href="#74-%E5%8A%A0%E8%BD%BD%E9%80%9F%E5%BA%A6">7.4 加载速度</a></li>
<li><a href="#75-%E5%85%B6%E4%BB%96">7.5 其他</a></li>
</ul>
</li>
<li><a href="#8-%E5%85%B3%E4%BA%8Etty">8 关于<code>tty</code></a></li>
<li><a href="#9-%E6%9C%80%E5%90%8E">9 最后</a></li>
</ul>
</p>
<h1 id="1-概述">1 概述</h1>
<p>作为一个程序员，可以没钱，没车，没房，没老婆，没女朋友。</p>
<p>但是，一定要有一个漂亮骚气的终端。</p>
<p><s>没错，大骚特骚。</s></p>
<p><s>说什么大实话。</s></p>
<p>先来看看原生的终端：</p>
<figure data-type="image" tabindex="1"><img src="https://img-blog.csdnimg.cn/20200512153727942.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p><s>真漂亮啊。</s></p>
<p>再看看美化过的：</p>
<figure data-type="image" tabindex="2"><img src="https://img-blog.csdnimg.cn/20200512133828301.png" alt="在这里插入图片描述" loading="lazy"></figure>
<figure data-type="image" tabindex="3"><img src="https://img-blog.csdnimg.cn/20200512133937571.png" alt="在这里插入图片描述" loading="lazy"></figure>
<figure data-type="image" tabindex="4"><img src="https://img-blog.csdnimg.cn/20200512133340522.png" alt="在这里插入图片描述" loading="lazy"></figure>
<figure data-type="image" tabindex="5"><img src="https://img-blog.csdnimg.cn/20200512171351446.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p><s>这才叫终端嘛。</s></p>
<p>美化过的就是不一样。</p>
<p>如果您也想要这样的终端，那这篇文章要仔细看，同时顺手点个赞。</p>
<p>文章讲述了如何使用<code>zsh</code>，配合主题<code>Powerlevel10k</code>（以下简称<code>p10k</code>）进行终端美化的过程，不废话了，进入正题。</p>
<h1 id="2-环境">2 环境</h1>
<p>笔者环境：</p>
<ul>
<li><code>Manjaro</code></li>
<li><code>Xfce</code></li>
<li>自带的<code>Xfce terminal</code></li>
</ul>
<p>其他<code>Linux</code>基本适用，安装<code>zsh</code>+<code>zinit</code>/<code>oh-my-zsh</code>即可，<code>Mac</code>用户可以通过<code>homebrew</code>安装<code>zsh</code>+<code>p10k</code>，至于<code>Win</code>用户，可以尝试<code>WSL</code>+图形界面。</p>
<h1 id="3-准备工作">3 准备工作</h1>
<p>安装<code>zsh</code>+<code>zinit</code>/<code>oh-my-zsh</code></p>
<h2 id="31-zsh">3.1 <code>zsh</code></h2>
<p><code>Manjaro/Arch</code>：</p>
<pre><code class="language-bash">yay -S zsh
</code></pre>
<p><code>Debian</code>系：</p>
<pre><code class="language-bash">sudo apt install zsh
</code></pre>
<p><code>RedHat</code>系：</p>
<pre><code class="language-bash">sudo yum install -y zsh
</code></pre>
<p>其他可以来到官方<code>Github</code>安装，<a href="https://github.com/zsh-users/zsh">戳这里</a>。</p>
<p>设为默认shell：</p>
<pre><code class="language-bash">chsh -s $(which zsh)
</code></pre>
<p>再把原来的别名复制到</p>
<pre><code class="language-bash">~/.zshrc
</code></pre>
<h2 id="32-zinitoh-my-zsh">3.2 <code>zinit</code>/<code>oh-my-zsh</code></h2>
<p>其实<code>p10k</code>安装有很多种方式，如图：</p>
<figure data-type="image" tabindex="6"><img src="https://img-blog.csdnimg.cn/20201024160220464.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>这里演示的是通过<code>zinit</code>或<code>oh-my-zsh</code>（以下简称<code>OMZ</code>安装）。</p>
<h3 id="321-zinit">3.2.1 <code>zinit</code></h3>
<p><code>zinit</code>是一个强大的<code>zsh</code>插件管理器，安装：</p>
<pre><code class="language-bash">sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/zdharma/zinit/master/doc/install.sh)&quot;
</code></pre>
<p>接着在<code>~/.zshrc</code>加上：</p>
<pre><code class="language-bash">zinit ice depth=1; 
zinit light romkatv/powerlevel10k
</code></pre>
<p>即可完成<code>p10k</code>的安装。</p>
<h3 id="322-omz">3.2.2 <code>OMZ</code></h3>
<p>首先安装<code>OMZ</code>：</p>
<pre><code class="language-bash">sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot;
#或
sh -c &quot;$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot;
</code></pre>
<p>失败的话可以<code>clone</code>仓库安装，<a href="https://github.com/ohmyzsh/ohmyzsh">戳这里</a>。</p>
<p>接着安装<code>p10k</code>：</p>
<pre><code class="language-bash">git clone --depth=1 https://gitee.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k
</code></pre>
<p>最后在<code>~/.zshrc</code>中定义加上主题：</p>
<pre><code class="language-bash">ZSH_THEME=&quot;powerlevel10k/powerlevel10k&quot;
</code></pre>
<h2 id="33-字体">3.3 字体</h2>
<p><code>Manjaro/Arch</code>用户：</p>
<pre><code class="language-bash">yay -S nerd-fonts-meslo
</code></pre>
<p>或手动安装：</p>
<ul>
<li><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Regular.ttf">MesloLGS NF Regular.ttf</a></li>
<li><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold.ttf">MesloLGS NF Bold.ttf</a></li>
<li><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Italic.ttf">MesloLGS NF Italic.ttf</a></li>
<li><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold%20Italic.ttf">MesloLGS NF Bold Italic.ttf</a></li>
</ul>
<p>其他系统的字体安装请参考其他博客，比如：</p>
<ul>
<li><a href="https://blog.csdn.net/bitcarmanlee/article/details/79729634"><code>Ubuntu</code>系</a></li>
<li><a href="https://www.cnblogs.com/lichmama/p/4160201.html"><code>RedHat</code>系</a></li>
</ul>
<h1 id="4-p10k基本配置">4 <code>p10k</code>基本配置</h1>
<p>如果是使用<code>zinit</code>安装的<code>p10k</code>，重新启动<code>zsh</code>即可，如果是<code>OMZ</code>安装的<code>p10k</code>，请手动输入：</p>
<pre><code class="language-bash">p10k configure
</code></pre>
<p>就会出现图形化配置向导。首先会问几个问题：</p>
<figure data-type="image" tabindex="7"><img src="https://img-blog.csdnimg.cn/20200511213925189.png" alt="在这里插入图片描述" loading="lazy"></figure>
<figure data-type="image" tabindex="8"><img src="https://img-blog.csdnimg.cn/2020051121395215.png" alt="在这里插入图片描述" loading="lazy"></figure>
<figure data-type="image" tabindex="9"><img src="https://img-blog.csdnimg.cn/20200511214010451.png" alt="在这里插入图片描述" loading="lazy"></figure>
<figure data-type="image" tabindex="10"><img src="https://img-blog.csdnimg.cn/20200512135516854.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>会问三个图标：钻石，锁与Debian，这个是测试有没有安装对应的字体，如果没有安装的话应该是不能正常显示图标的，然后会问图标是否会重叠，接着有四种风格可以选择：</p>
<figure data-type="image" tabindex="11"><img src="https://img-blog.csdnimg.cn/20200512141652442.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>从这里开始就是自定义配置了，笔者选的3 ，接着可以选择：</p>
<ul>
<li>编码（<code>Unicode</code>/<code>ASCII</code>）</li>
<li>时间（不显示/12小时制/24小时制）</li>
<li>提示段分隔符（三角/垂直/斜线/圆角）</li>
<li>提示段头部（三角/渐隐/斜线/垂直）</li>
<li>提示段尾部（垂直/渐隐/三角/倾斜/圆角）</li>
<li>高度（一行/两行）</li>
<li>左右提示段连接方式（无/点状连接/实线连接）</li>
<li>提示段旁的命令提示符（无/左/右/左+右）</li>
<li>颜色（最亮/亮/暗/最暗）</li>
<li>空格（稀疏/紧密）</li>
<li>图标（少/多）</li>
<li>提示段流（<code>Prompt Flow</code>）（简洁/流畅，相比起简洁模式，对于时间、<code>Git</code>分支等流畅模式会显示更多文字或图标）</li>
<li>临时提示（开启/关闭）</li>
<li>即时提示模式（关闭/安静模式/啰嗦模式，官方是推荐啰嗦模式的，关闭是已经尝试过即时提示模式，但是不兼容zsh配置，需要关闭，安静模式建议已经阅读了即时提示模式文档后使用）</li>
</ul>
<ul>
<li>覆盖p10k配置文件（如果p10k配置文件已存在，会提示是否覆盖，不覆盖的话也就是相当于此次配置无效，需要覆盖才能生效），覆盖之前原文件会备份</li>
</ul>
<p>简单配置的效果：</p>
<figure data-type="image" tabindex="12"><img src="https://img-blog.csdnimg.cn/20200512143546614.png" alt="在这里插入图片描述" loading="lazy"></figure>
<h1 id="5-p10k自定义配置">5 <code>p10k</code>自定义配置</h1>
<p>由于<code>p10k</code>是<code>p9k</code>的一个分支（关于<code>p9k</code>的相关描述请看文末），对于<code>p9k</code>的配置大部分都是兼容的，因此这里以<code>p9k</code>的配置为例进行说明。</p>
<h2 id="51-如何修改配置文件">5.1 如何修改配置文件？</h2>
<p>首先要知道配置文件的默认位置为：</p>
<pre><code class="language-bash">~/.p10k.zsh
</code></pre>
<figure data-type="image" tabindex="13"><img src="https://img-blog.csdnimg.cn/20201024165513119.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>这是默认的配置，在<code>vcs</code>下面添加一个<code>time</code>：</p>
<figure data-type="image" tabindex="14"><img src="https://img-blog.csdnimg.cn/20201024165636984.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>就会看到左边也多了一个时间：</p>
<figure data-type="image" tabindex="15"><img src="https://img-blog.csdnimg.cn/20201024165655426.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>这样提示段就可以很轻松地进行自定义了。</p>
<h2 id="52-提示段">5.2 提示段</h2>
<h3 id="521-开启关闭整个提示段">5.2.1 开启/关闭整个提示段</h3>
<p>关闭左边/右边整个提示段：</p>
<pre><code class="language-bash"># 左
# 注左边的提示段测试关闭失败，可能是p10k强制不允许关闭左边提示段的原因
typeset -g POWERLEVEL9K_DISABLE_PROMPT=true
#右
typeset -g POWERLEVEL9K_DISABLE_RPROMPT=true
</code></pre>
<h3 id="522-系统相关">5.2.2 系统相关</h3>
<ul>
<li><code>background_jobs</code>：后台任务</li>
<li><code>battery</code>：电池状态</li>
<li><code>context</code>：用户名+主机名，基于<code>USER</code>环境变量以及<code>SSH</code>状态</li>
<li><code>date</code>：日期</li>
<li><code>dir</code>：当前工作目录</li>
<li><code>dir_writable</code>：当前目录可写状态，可写时为空，不可写时有一个锁</li>
<li><code>disk_usage</code>：当前分区的磁盘使用百分比</li>
<li><code>history</code>：历史命令记录数量</li>
<li><code>host</code>：主机名</li>
<li><code>ip</code>：内网<code>ip</code></li>
<li><code>vpn_ip</code>：<code>vpn_ip</code></li>
<li><code>public_ip</code>：公网<code>ip</code></li>
<li><code>load</code>：机器的平均负载</li>
<li><code>os_icon</code>：操作系统图标，支持的系统有<code>Apline</code>、<code>AOSC</code>、<code>Arch</code>、<code>CentOS</code>、<code>CoreOS</code>、<code>Debian</code>、<code>Devuan</code>、<code>Elementary</code>、<code>Fedora</code>、<code>Gentoo</code>、<code>Mageia</code>、<code>Manjaro</code>、<code>Mint</code>、<code>NixOS</code>、<code>OpenSUSE</code>、<code>Sabayon</code>、<code>Slackware</code>、<code>Ubuntu</code></li>
<li><code>ram</code>：可用内存大小</li>
<li><code>root_indicator</code>：拥有<code>root</code>权限的提示符</li>
<li><code>status</code>：前一条命令的结果状态码</li>
<li><code>swap</code>：交换分区使用情况</li>
<li><code>time</code>：时间</li>
<li><code>user</code>：当前用户</li>
<li><code>vi_mode</code>：<code>vi</code>模式</li>
<li><code>ssh</code>：<code>ssh</code>状态</li>
</ul>
<h3 id="523-语言相关">5.2.3 语言相关</h3>
<ul>
<li><code>go_version</code>：<code>Go</code>版本</li>
<li><code>node_version</code>：<code>Node.js</code>版本</li>
<li><code>nodeenv</code>：<code>nodeenv</code>显示的<code>Node</code>版本</li>
<li><code>nvm</code>：<code>NVM</code>显示的<code>Node</code>版本</li>
<li><code>php_version</code>：<code>php</code>版本</li>
<li><code>laravel_version</code>：<code>Laravel</code>版本</li>
<li><code>symfony2_test2</code>：<code>Symfony2</code>测试类与代码类的比率</li>
<li><code>symfony2_version</code>：<code>Symfony2</code>版本</li>
<li><code>virtualenv</code>：<code>Python</code>的<code>VirtualEnv</code>环境</li>
<li><code>anaconda</code>：<code>Anaconda</code>环境</li>
<li><code>pyenv</code>：<code>pyenv version</code>命令显示的第一个单词，但是如果是<code>system</code>将不会显示</li>
<li><code>chruby</code>：使用<code>chruby</code>的<code>Ruby</code>环境</li>
<li><code>rbenv</code>：使用<code>rbenv</code>的<code>Ruby</code>环境</li>
<li><code>rspec_status</code>：<code>RSpec</code>中测试类与代码类的比率</li>
<li><code>rvm</code>：使用<code>GEM_HOME</code>环境变量或者<code>MY_RUBY_HOME</code>环境变量显示的<code>Ruby</code>信息</li>
<li><code>rust_version</code>：<code>Rust</code>版本</li>
<li><code>swift_version</code>：<code>Swift</code>版本</li>
<li><code>java_version</code>：<code>Java</code>版本</li>
<li><code>openfoam</code>：<code>OpenFOAM</code>库版本</li>
</ul>
<p>笔者认为这类提示符的用处不是很大，因为具体环境的话自己应该是清楚的，因此笔者没有选择这类进行配置。</p>
<h3 id="524-云相关">5.2.4 云相关</h3>
<ul>
<li><code>aws</code>：当前的<code>AWS</code>配置</li>
<li><code>aws_eb_env</code>：当前的<code>Elastic Beanstalk</code>环境</li>
<li><code>docker_machine</code>：当前的<code>Docker Machine</code></li>
<li><code>docker_machine</code>：<code>kubectl</code>配置</li>
<li><code>dropbox</code>：<code>Dropbox</code>目录以及使用<code>dropbox-cli</code>的同步状态</li>
</ul>
<h3 id="525-其他">5.2.5 其他</h3>
<ul>
<li><code>vcs</code>：<code>git</code>/<code>hg</code>仓库的信息</li>
<li><code>command_execution_time</code>：命令执行时间</li>
<li><code>todo</code>：<a href="http://todotxt.org/">todo.txt</a>文件中任务数量</li>
<li><code>detect_virt</code>：使用<code>systemd</code>进行虚拟化检测</li>
<li><code>newline</code>：另起一行</li>
<li><code>custom_command</code>：自定义命令，需要以<code>custom_</code>开头</li>
</ul>
<p>比如，利用</p>
<pre><code class="language-bash">nmcli device wifi
</code></pre>
<p>显示wifi速率，首先添加一个函数：</p>
<pre><code class="language-bash">wifi_rate(){
	local rate=$(nmcli device wifi | grep -E &quot;\*&quot; | awk '{print $6}') #awk后面的数字可能每个人不同
	echo &quot;\uf0e7 $rate Mbit/s&quot;
}
</code></pre>
<p>其次添加自定义提示段（以custom开头）：</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_CUSTOM_WIFI_RATE=&quot;wifi_rate&quot;
</code></pre>
<p>最后在</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_LEFT_PROMPT_ELEMENTS
#或
typeset -g POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS
</code></pre>
<p>加上即可，演示效果：</p>
<figure data-type="image" tabindex="16"><img src="https://img-blog.csdnimg.cn/20200512041033356.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>需要的话，可以根据信号状态定义不同的颜色：</p>
<figure data-type="image" tabindex="17"><img src="https://img-blog.csdnimg.cn/20200512041421959.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>完整配置文件如下，加上了<code>wifi</code>名字：</p>
<pre><code class="language-bash">set_wifi()
{
  wifi_signal=$(nmcli device wifi | grep -E &quot;\*&quot; | awk '{print $8}')
  typeset -g POWERLEVEL9K_CUSTOM_WIFI_NAME_FOREGROUND=&quot;black&quot;
  typeset -g POWERLEVEL9K_CUSTOM_WIFI_RATE_FOREGROUND=&quot;black&quot;
  typeset -g POWERLEVEL9K_CUSTOM_WIFI_BARS_AND_SIGNAL_FOREGROUND=&quot;black&quot;

  typeset -g POWERLEVEL9K_CUSTOM_WIFI_NAME_BACKGROUND=&quot;green&quot; 
  typeset -g POWERLEVEL9K_CUSTOM_WIFI_RATE_BACKGROUND=&quot;green&quot;
  typeset -g POWERLEVEL9K_CUSTOM_WIFI_BARS_AND_SIGNAL_BACKGROUND=&quot;green&quot;

  if [[ $wifi_signal -lt 50 ]] ; then 
    typeset -g POWERLEVEL9K_CUSTOM_WIFI_NAME_BACKGROUND=&quot;red&quot;
    typeset -g POWERLEVEL9K_CUSTOM_WIFI_RATE_BACKGROUND=&quot;red&quot;
    typeset -g POWERLEVEL9K_CUSTOM_WIFI_BARS_AND_SIGNAL_BACKGROUND=&quot;red&quot;
  elif [[ $wifi_signal -lt 75 ]] ; then 
    typeset -g POWERLEVEL9K_CUSTOM_WIFI_NAME_BACKGROUND=&quot;yellow&quot;
    typeset -g POWERLEVEL9K_CUSTOM_WIFI_RATE_BACKGROUND=&quot;yellow&quot;
    typeset -g POWERLEVEL9K_CUSTOM_WIFI_BARS_AND_SIGNAL_BACKGROUND=&quot;yellow&quot;
  fi
}
set_wifi

wifi_name(){
  local name=$(nmcli device wifi | grep -E &quot;\*&quot; | awk '{print $3}')
  echo &quot;\uf502 $name&quot;
}
wifi_rate(){
  local rate=$(nmcli device wifi | grep -E &quot;\*&quot; | awk '{print $6}')
  echo &quot;\uf0e7 $rate Mbit/s&quot;
}
wifi_bars_and_signal(){
  local bars=$(nmcli device wifi | grep -E &quot;\*&quot; | awk '{print $9}')
  echo &quot;$bars $wifi_signal %%&quot;
}

typeset -g POWERLEVEL9K_CUSTOM_WIFI_NAME=&quot;wifi_name&quot;
typeset -g POWERLEVEL9K_CUSTOM_WIFI_RATE=&quot;wifi_rate&quot;
typeset -g POWERLEVEL9K_CUSTOM_WIFI_BARS_AND_SIGNAL=&quot;wifi_bars_and_signal&quot;

typeset -g POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(
  # =========================[ Line #1 ]=========================
  date
  dir                     # current directory
  dir_writable
  vcs                     # git status
  newline
  # =========================[ Line #2 ]=========================
  ram
  # prompt_char           # prompt symbol
  custom_wifi_name 
  custom_wifi_rate 
  custom_wifi_bars_and_signal 
)
</code></pre>
<p>注意提示段并不是越多越好，太多的话会有点显得过于花里胡哨，而且会影响速度。</p>
<h2 id="53-颜色">5.3 颜色</h2>
<p>修改提示段的前景/背景，直接修改即可，一般的格式为：</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_NAME_STATUS_BACKGROUND=
typeset -g POWERLEVEL9K_NAME_STATUS_FOREGROUND=
</code></pre>
<p>其中<code>NAME</code>为5.1小节中对应的提示段，比如可以修改：</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_OS_ICON_FOREGROUND=&quot;green&quot;
typeset -g POWERLEVEL9K_PHP_VERSION_BACKGROUND=&quot;010&quot;
</code></pre>
<p>颜色可以使用一些常见的<code>red</code>/<code>green</code>等等，也可以使用序号，可以查看这张图：</p>
<figure data-type="image" tabindex="18"><img src="https://img-blog.csdnimg.cn/20200512104645305.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>也可以使用如下命令显示颜色：</p>
<pre><code class="language-bash">for i in {0..255}; do print -Pn &quot;%K{$i}  %k%F{$i}${(l:3::0:)i}%f &quot; ${${(M)$((i%6)):#3}:+$'\n'}; done
</code></pre>
<p><code>STATUS</code>不是每个提示段都有的，拥有<code>STATUS</code>的提示段如下：</p>
<ul>
<li><code>battery</code>：<code>LOW</code>、<code>CHARGING</code>、<code>CHAGED</code>、<code>DISCONNECTED</code></li>
<li><code>context</code>：<code>DEFAULT</code>、<code>ROOT</code>、<code>SUDO</code>、<code>REMOTE</code>、<code>REMOTE_SUDO</code></li>
<li><code>dir</code>：<code>HOME</code>、<code>HOME_SUBFOLDER</code>、<code>DEFAULT</code>、<code>ETC</code>、<code>NOT_WRITABLE</code></li>
<li><code>dir_writable</code>：<code>FORBIDDEN</code></li>
<li><code>disk_usage</code>：<code>NORMAL</code>、<code>WARNING</code>、<code>CRITICAL</code></li>
<li><code>host</code>：<code>LOCAL</code>、<code>REMOTE</code></li>
<li><code>load</code>：<code>CRITICAL</code>、<code>WARNING</code>、<code>NORMAL</code></li>
<li><code>rspec_stats</code>：<code>STATS_GOOD</code>、<code>STATS_AVG</code>、<code>STATS_BAD</code></li>
<li><code>symfony2_test</code>：<code>TESTS_GOOD</code>、<code>TESTS_AVG</code>、<code>TESTS_BAD</code></li>
<li><code>user</code>：<code>DEFAULT</code>、<code>SUDO</code>、<code>ROOT</code></li>
<li><code>vcs</code>：<code>CLEAN</code>、<code>UNTRACKED</code>、<code>MODIFIED</code></li>
<li><code>vi_mode</code>：<code>NORMAL</code>、<code>INSERT</code>、<code>VISUAL</code></li>
</ul>
<p>大部分都可以很容易理解，这里以最简单的为例：</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_DIR_DEFAULT_BACKGROUND='166'
typeset -g POWERLEVEL9K_DIR_DEFAULT_FOREGROUND='000'
typeset -g POWERLEVEL9K_DIR_ETC_BACKGROUND='226'
typeset -g POWERLEVEL9K_DIR_ETC_FOREGROUND='000'
typeset -g POWERLEVEL9K_DIR_HOME_BACKGROUND='044'
typeset -g POWERLEVEL9K_DIR_HOME_FOREGROUND='000'
</code></pre>
<p>设置<code>home</code>目录，<code>etc</code>目录以及默认目录的前景与背景。</p>
<p>另外需要注意的是显示的颜色还与终端本身的设置颜色有关，请到具体的终端配置去修改：</p>
<figure data-type="image" tabindex="19"><img src="https://img-blog.csdnimg.cn/20201024194935194.png" alt="在这里插入图片描述" loading="lazy"></figure>
<h2 id="54-位置">5.4 位置</h2>
<p>可以加上</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_PROMPT_ON_NEWLINE=true
</code></pre>
<p>使输入的命令显示在新的一行。</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_RPROMPT_ON_NEWLINE=true
</code></pre>
<p>让右边的提示段在新的一行。<br>
在</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_LEFT_PROMPT_ELEMETS
#或
typeset -g POWERLEVEL9K_RIGHT_PROMPT_ELEMETS
</code></pre>
<p>中，可以配合<code>newline</code>以及5.1中的提示段自定义位置，示例如下：</p>
<pre><code class="language-bash">POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(
	os_icon date time newline 
	custom_wifi_rate custom_wifi_bars_and_signal newline
	background_jobs ram load swap disk_usage newline 
	php_version java_version node_version newline 
	dir dir_writable vcs 
)
</code></pre>
<h2 id="55-图标">5.5 图标</h2>
<p>使用</p>
<pre><code class="language-bash">get_icon_names
</code></pre>
<p>可以查看内置的图标。<br>
<img src="https://img-blog.csdnimg.cn/20200512110355831.png" alt="在这里插入图片描述" loading="lazy"></p>
<p>注意这个和字体有关，如果使用默认的<code>PowerlineFonts</code>或者使用<code>AwesomeFonts</code>可能不会完整显示所有图标，请使用Nerd-Fonts。</p>
<p><a href="https://www.oschina.net/p/nerd-fonts">戳这里</a>查看Nerd-fonts的部分图标，<a href="https://www.nerdfonts.com/cheat-sheet">戳这里</a>（国外网站）搜索所有的图标。</p>
<p>官方的例子是自定义<code>vcs</code>的图标：</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_VCS_BRANCH_ICON=$'\uF126'
</code></pre>
<p>F126可以通过上面的网站搜索得到，是一个分支的图标：</p>
<figure data-type="image" tabindex="20"><img src="https://img-blog.csdnimg.cn/2020051211145535.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>其他<code>git</code>相关图标：</p>
<ul>
<li><code>Github</code>：<code>VCS_GIT_GITHUB_ICON</code></li>
<li><code>BitBucket</code>：<code>VCS_GIT_BITBUCKET_ICON</code></li>
<li><code>GitLab</code>：<code>VCS_GIT_GITLAB_ICON</code></li>
<li>其他：<code>VCS_GIT_ICON</code></li>
</ul>
<p>另外还可以修改提示段前的图标：</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_MULTILINE_FIRST_PROMPT_PREFIX=&quot;↱&quot;
typeset -g POWERLEVEL9K_MULTILINE_LAST_PROMPT_PREFIX=&quot;↳ &quot;
typeset -g POWERLEVEL9K_MULTILINE_NEWLINE_PROMPT_PREFIX=&quot;xxx&quot;
</code></pre>
<p>还可以根据<code>get_icon_names</code>修改默认图标，比如，修改</p>
<pre><code class="language-bash">typeset -g POWERLEVEL9K_HOME_SUB_ICON=$'\uf74b'
</code></pre>
<figure data-type="image" tabindex="21"><img src="https://img-blog.csdnimg.cn/20200512114150180.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>但是直接改<code>icon</code>的话图标会显示得很小，可以在函数中像上面的<code>wifi</code>一样使用<code>echo</code>自定义。</p>
<h1 id="6-配置文件">6 配置文件</h1>
<p>笔者的配置文件，仅供参考：</p>
<ul>
<li><a href="https://github.com/2293736867/BeautifulP10KConfig">Github</a></li>
<li><a href="https://gitee.com/u6b7b5fc3/BeautifulP10KConfig">码云</a></li>
</ul>
<h1 id="7-杂项">7 杂项</h1>
<h2 id="71-文章更新">7.1 文章更新</h2>
<p>这篇文章其实是从笔者之前的文章修改更新过来的，由于之前的那一篇写得有点混乱，这里重新排版并修正了一些错误。</p>
<h2 id="72-关于p9k">7.2 关于<code>p9k</code></h2>
<p><strong>（以下部分针对<code>p9k</code>的老用户，刚接触<code>p10k</code>的可以略过）</strong></p>
<p>前面提到<code>p10k</code>是<code>p9k</code>的一个分支，<code>p10k</code>是2019年3月从<code>p9k</code>的仓库<code>fork</code>而来的。<code>p9k</code>已经是一个拥有大量用户的成熟的工程。<code>p10k</code>被分离出来，以更快的速度迭代更新，添加新特性以及改进性能。</p>
<p><code>p9k</code>与<code>p10k</code>是独立的项目，只能安装其中一个，但是<code>p10k</code>会识别<code>p9k</code>的所有参数。</p>
<p><strong>目前<code>p9k</code>已经不再维护更新，推荐使用<code>p10k</code>。</strong></p>
<figure data-type="image" tabindex="22"><img src="https://img-blog.csdnimg.cn/20200511095752966.png" alt="在这里插入图片描述" loading="lazy"></figure>
<h2 id="73-提示延迟">7.3 提示延迟</h2>
<p>笔者认为出现<code>p10k</code>的主要原因就是<code>p9k</code>很慢，比如这是<code>p9k</code>的<code>issue</code>：</p>
<figure data-type="image" tabindex="23"><img src="https://img-blog.csdnimg.cn/20200511100009605.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>具体内容请查看<code>p9k</code>官方<code>issue</code>，<code>p10k</code>改进了性能，<code>p10k Github</code>有一个演示视频，展示了<code>p10k</code>的速度，在<code>Intel i9-7900X+Ubuntu 18.04</code>上，测试提示延迟如下：</p>
<figure data-type="image" tabindex="24"><img src="https://img-blog.csdnimg.cn/20200511100206835.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p><strong>（来源官方测试）</strong></p>
<p>相对来说，<code>p9k</code>具有可接受的延迟，如果只是需要当前目录而不需要截断或缩短，<code>p9k</code>可以17ms内渲染完成，<code>p10k</code>可以将其提高30倍的渲染速度，但实际上并不需要，因为延迟变得明显的阀值为50ms。官方建议必须小心使用<code>p9k</code>的配置，因为很容易使得提示变慢，但是<code>p10k</code>在任何配置中几乎都是即时的，可以保持远低于50ms。</p>
<p>另外笔者的系统上也测试过，<code>p9k</code>确实要比<code>p10k</code>慢，添加了很多设置后，<code>p9k</code>在终端中连续按Enter，松手之后还在提示，甚至一个普通的<code>ls</code>也有明显的延迟，但是<code>p10k</code>没有这样的问题，很流畅。</p>
<h2 id="74-加载速度">7.4 加载速度</h2>
<p><code>p10k</code>比<code>p9k</code>能更快加载，前提是，<code>zsh</code>版本5.4+。</p>
<p>官方建议使用下面的命令测试：</p>
<pre><code class="language-bash">time (repeat 1000 zsh -dfis &lt;&lt;&lt; 'source ~/powerlevel10k/powerlevel10k.zsh-theme')
</code></pre>
<p>但是笔者没有这个文件，怀疑是位置给错了，修改如下：</p>
<pre><code class="language-bash">time (repeat 1000 zsh -dfis &lt;&lt;&lt; 'source /usr/share/zsh-theme-powerlevel10k/powerlevel10k/powerlevel10k.zsh-theme')
</code></pre>
<p>笔者的系统上耗时如下：</p>
<figure data-type="image" tabindex="25"><img src="https://img-blog.csdnimg.cn/2020051120031034.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>换了<code>p9k</code>后：</p>
<pre><code class="language-bash">time (repeat 1000 zsh -dfis &lt;&lt;&lt; 'source /usr/share/zsh-theme-powerlevel9k/powerlevel9k.zsh-theme')
</code></pre>
<p>耗时如下：</p>
<figure data-type="image" tabindex="26"><img src="https://img-blog.csdnimg.cn/20200511201744364.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>不过好像没快多少的样子，可能是<code>zsh</code>版本的问题，装的是目前最新的<code>5.8</code>，可能老一点的版本区别会明显一点。</p>
<p>官方的测试是<code>p10k</code>用了29s，比相同环境下的<code>p9k master</code>分支大约快6倍，比<code>p9k next</code>分支快17倍。笔者认为仅供参考吧，用<code>p10k</code>就对了，毕竟比<code>p9k</code>快。</p>
<h2 id="75-其他">7.5 其他</h2>
<ul>
<li><code>p10k</code>默认只开启<code>vcs</code>中<code>git</code>后端的支持，如果需要<code>svn</code>/<code>hg</code>，需要添加到<code>typeset -g POWERLEVEL9K_VCS_BACKENDS</code>。但是<code>p10k</code>还没有针对<code>svn</code>/<code>hg</code>优化，所以添加的话会让提示变慢</li>
<li><code>p10k</code>不支持<code>typeset -g POWERLEVEL9K_VCS_SHOW_SUBMODULE_DIRTY=true</code></li>
<li><code>p10k</code>会兼容<code>p9k</code>的所有选项，因此，相同配置下如果<code>p9k</code>与<code>p10k</code>看到的图标不一样，可能是设置了<code>typeset -g POWERLEVEL9K_MODE</code>的原因，请去掉<code>typeset -g POWERLEVEL9K_MODE</code></li>
<li><code>p9k</code>不识别<code>typeset -g ZLE_RPROMPT_INDENT</code>，因此<code>p10k</code>相比起<code>p9k</code>会有额外的空格。如果不想要可以设置<code>typeset -g ZLE_RPROMPT_INDENT=0</code></li>
</ul>
<figure data-type="image" tabindex="27"><img src="https://img-blog.csdnimg.cn/20200512145835247.png" alt="在这里插入图片描述" loading="lazy"></figure>
<ul>
<li><code>p9k</code>在图标附近有不一致的空格，在<code>p10k</code>已经不存在了，不过可以设置<code>typeset -g POWERLEVEL9K_LEGACY_ICON_SPACING=true</code>显示与p9k中一样的空格</li>
</ul>
<figure data-type="image" tabindex="28"><img src="https://img-blog.csdnimg.cn/20200512145806760.png" alt="在这里插入图片描述" loading="lazy"></figure>
<ul>
<li><code>p10k</code>修正了<code>p9k</code>的许多bugs，除了修复空格问题等，最主要是极大地提高了速度</li>
</ul>
<h1 id="8-关于tty">8 关于<code>tty</code></h1>
<p>由于<code>p10k</code>可以配置得非常炫酷，因此想要在<code>tty</code>上显示是几乎不现实的，这里建议的做法是，准备两套主题，一套在<code>GUI</code>使用，一套在<code>tty</code>使用，建议的做法是先备份在<code>GUI</code>上的主题（<code>~/.p10.zsh</code>）：</p>
<pre><code class="language-bash">cp ~/.p10k.zsh ~/.p10k.zsh.gui
</code></pre>
<p>然后再运行一次<code>p10k configure</code>选择<code>Lean</code>：</p>
<figure data-type="image" tabindex="29"><img src="https://img-blog.csdnimg.cn/20201024225845776.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>注意字符集需要选择<code>ASCII</code>：</p>
<figure data-type="image" tabindex="30"><img src="https://img-blog.csdnimg.cn/20201024225957945.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>颜色不能选择256，否则显示不出来：</p>
<figure data-type="image" tabindex="31"><img src="https://img-blog.csdnimg.cn/20201024230012233.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>简单配置后的效果：</p>
<figure data-type="image" tabindex="32"><img src="https://img-blog.csdnimg.cn/20201024231946709.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>虽然确实是普通了一点，但胜在通用。</p>
<p>首先备份生成的主题：</p>
<pre><code class="language-bash">cp ~/.p10k.zsh ~/.p10k.zsh.tty
</code></pre>
<p>这样需要的时候进行手动切换即可：</p>
<pre><code class="language-bash"># GUI
cp ~/.p10k.zsh.gui ~/.p10k.zsh
# tty
cp ~/.p10k.zsh.tty ~/.p10k.zsh
</code></pre>
<h1 id="9-最后">9 最后</h1>
<p>首先本文写作日期是10月24日，先祝所有的程序员节日快乐，写的代码永远没有bug。</p>
<p>说了这么多，如果是<code>p9k</code>的用户强烈建议迁移到<code>p10k</code>，官方有迁移指南，<a href="https://github.com/romkatv/powerlevel10k#im-using-powerlevel9k-with-oh-my-zsh-how-do-i-migrate">戳这里</a>。</p>
<p>另外如果想配置一个真正漂亮实用又快速高效的终端是真的需要一点动手能力的，希望看完这篇文章的读者能收到启发，去配置一个自己专属的终端。</p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://2293736867.github.io/post/mei-ri-fen-xiang-di-131-qi/">
              <h3 class="post-title">
                下一篇：每日分享 第131期
              </h3>
            </a>
          </div>
          
      </div>

      
        
          <div id="gitalk-container"></div>
        

        
      

      <div class="site-footer">
  <div class="slogan">我配不上你，
纵然很努力。</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://2293736867.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '477bf133e6f4f92e3d3d',
        clientSecret: 'c917fc4292d22d69e98b9521ac1e6fca627fe54c',
        repo: '2293736867.github.io',
        owner: '2293736867',
        admin: ['2293736867'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
