
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>解决CentOS虚拟机无法显示本地IP问题 | 氷泠&#39;s blog</title>
<meta name="description" content="我配不上你，
纵然很努力。">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://2293736867.github.io/favicon.ico?v=1615371949211">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://2293736867.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://2293736867.github.io">
        <img class="avatar" src="https://2293736867.github.io/images/avatar.png?v=1615371949211" alt="" width="32px" height="32px">
      </a>
      <a href="https://2293736867.github.io">
        <h1 class="site-title">氷泠&#39;s blog</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://2293736867.github.io/post-images/jie-jue-centos-xu-ni-ji-wu-fa-xian-shi-ben-di-ip-wen-ti.png')">
            </div>
          
          <h2 class="post-title">解决CentOS虚拟机无法显示本地IP问题</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2020-12-08</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://2293736867.github.io/tag/mIpAXBTpr/">
                    虚拟机
                    
                      ，
                    
                  </a>
                
                  <a href="https://2293736867.github.io/tag/wtA4qyubx/">
                    Linux
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <p><ul class="markdownIt-TOC">
<li><a href="#1-%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0">1 问题描述</a></li>
<li><a href="#2-%E5%B0%9D%E8%AF%95%E8%BF%87%E7%9A%84%E6%96%B9%E6%B3%95">2 尝试过的方法</a></li>
<li><a href="#3-%E5%8E%9F%E5%9B%A0">3 原因</a></li>
<li><a href="#4-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">4 解决方案</a>
<ul>
<li><a href="#41-%E4%BD%BF%E7%94%A8network">4.1 使用<code>network</code></a></li>
<li><a href="#42-%E4%BD%BF%E7%94%A8networkmanager">4.2 使用<code>NetworkManager</code></a>
<ul>
<li><a href="#421-%E6%89%98%E7%AE%A1%E7%8A%B6%E6%80%81">4.2.1 托管状态</a></li>
<li><a href="#422-%E8%AE%BE%E5%A4%87">4.2.2 设备</a></li>
<li><a href="#423-%E9%9D%99%E6%80%81ip%E6%96%B9%E5%BC%8F">4.2.3 静态<code>ip</code>方式</a></li>
<li><a href="#424-%E5%8A%A8%E6%80%81ip%E6%96%B9%E5%BC%8F">4.2.4 动态<code>ip</code>方式</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</p>
<h1 id="1-问题描述">1 问题描述</h1>
<p><code>CentOS</code>虚拟机无法显示本地<code>ip</code>，如图：</p>
<figure data-type="image" tabindex="1"><img src="https://img-blog.csdnimg.cn/20201208085647996.png" alt="在这里插入图片描述" loading="lazy"></figure>
<h1 id="2-尝试过的方法">2 尝试过的方法</h1>
<p>参考过<a href="https://blog.csdn.net/qq_41264674/article/details/88246567">此处</a>的解决方法，把网卡配置中的<code>ONBOOT</code>修改为<code>YES</code>：</p>
<figure data-type="image" tabindex="2"><img src="https://img-blog.csdnimg.cn/20201208085800714.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>但是原来的网卡配置也是<code>YES</code>，所以修改的方法没有用，尝试了一下重启网卡服务：</p>
<pre><code class="language-bash">systemctl restart network
</code></pre>
<p><code>ip</code>还是无法正常显示。</p>
<h1 id="3-原因">3 原因</h1>
<p>查了一下资料，常用的<code>Linux</code>的网络管理服务有两个：</p>
<ul>
<li><code>network</code>服务</li>
<li><code>NetworkManager</code>服务</li>
</ul>
<p>前者是基础服务，通常在服务器中使用，当然在图形界面也有，通常使用命令行配置，而<code>NetworkManager</code>一般在图形界面安装，是为了方便<code>ip</code>的配置，要注意的是两个之中只能有一个生效，因此需要选择一个禁用。在笔者这种情况下应该是两者冲突了，导致不能正常显示本地<code>ip</code>，可以使用</p>
<pre><code class="language-bash">systemctl status network
systemctl status NetworkManager
</code></pre>
<p>查看两服务状态，如果不是服务冲突的话应该就是配置出错了的原因。</p>
<h1 id="4-解决方案">4 解决方案</h1>
<h2 id="41-使用network">4.1 使用<code>network</code></h2>
<p>先把<code>NetworkManager</code>禁用：</p>
<pre><code class="language-bash">systemctl stop NetworkManager
systemctl status NetworkManager
</code></pre>
<p>禁用之后重启<code>network</code>：</p>
<pre><code class="language-bash">systemctl restart network
</code></pre>
<p>这样就能显示出本地<code>ip</code>了。</p>
<p>若还是不能显示请检查网卡配置，在<code>/etc/sysconfig/network-scripts</code>下，笔者的是<code>/etc/sysconfig/network-scripts/ifcfg-ens33</code>。</p>
<h2 id="42-使用networkmanager">4.2 使用<code>NetworkManager</code></h2>
<p>使用<code>NetworkManager</code>的话先把<code>network</code>禁用：</p>
<pre><code class="language-bash">systemctl stop network
systemctl status network
</code></pre>
<p>再把<code>NetworkManager</code>启动：</p>
<pre><code class="language-bash">systemctl start NetworkManager
</code></pre>
<p>接下来使用<code>nmcli</code>进行操作。</p>
<h3 id="421-托管状态">4.2.1 托管状态</h3>
<p>首先查看托管状态：</p>
<pre><code class="language-bash">nmcli n
</code></pre>
<p>若显示<code>disabled</code>：</p>
<figure data-type="image" tabindex="3"><img src="https://img-blog.csdnimg.cn/20201208093511329.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>开启即可：</p>
<pre><code class="language-bash">nmcli n on
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://img-blog.csdnimg.cn/2020120809355423.png" alt="在这里插入图片描述" loading="lazy"></figure>
<h3 id="422-设备">4.2.2 设备</h3>
<p>查看设备：</p>
<pre><code class="language-bash">nmcli d
</code></pre>
<p>笔者机器上显示如下：</p>
<figure data-type="image" tabindex="5"><img src="https://img-blog.csdnimg.cn/20201208093141329.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>接下来创建连接，有两种方式创建：动/静态<code>ip</code>：</p>
<pre><code class="language-bash"># 静态ip方式创建connection
nmcli c add type ethernet con-name connect_name_1 ifname ens33 ipv4.addr 192.168.126.151/24 ipv4.gateway 192.168.126.1 ipv4.method manual

# 动态ip方式创建connection
nmcli c add type ethernet con-name connect_name_2 ifname ens33 ipv4.method auto
</code></pre>
<h3 id="423-静态ip方式">4.2.3 静态<code>ip</code>方式</h3>
<pre><code class="language-bash">nmcli c add type ethernet con-name connect_name_1 ifname ens33 ipv4.addr 192.168.126.151/24 ipv4.gateway 192.168.126.1 ipv4.method manual
</code></pre>
<p>参数说明：</p>
<ul>
<li><code>nmcli c add</code>：创建连接</li>
<li><code>type</code>：连接类型</li>
<li><code>con-name</code>：连接名称</li>
<li><code>ifname</code>：网卡名</li>
<li><code>ipv4.addr</code>：<code>ipv4</code>静态<code>ip</code>，这里是<code>192.168.126.151</code>，<code>24</code>表示子网掩码</li>
<li><code>ipv4.gateway</code>：网关，把最后<code>ip</code>最后置<code>1</code>即可，这里是<code>192.168.126.1</code></li>
<li><code>ipv4.method</code>：后面的参数<code>manual</code>表示配置静态<code>ip</code>，注意一下该参数很重要，因为默认为<code>auto</code>，也就是如果不指定该参数会出现两个<code>ip</code>，一个静态+一个动态</li>
</ul>
<p>创建好连接之后应该就能显示<code>ip</code>了：</p>
<figure data-type="image" tabindex="6"><img src="https://img-blog.csdnimg.cn/20201208095500972.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>就是刚才手动指定的静态<code>ip</code>，如果还是不能显示<code>ip</code>可以手动连接设备：</p>
<pre><code class="language-bash">nmcli d connect ens33
</code></pre>
<h3 id="424-动态ip方式">4.2.4 动态<code>ip</code>方式</h3>
<pre><code class="language-bash">nmcli c add type ethernet con-name connect_name_2 ifname ens33 ipv4.method auto
</code></pre>
<p>参数与上面的基本一致，区别就是<code>auto</code>，表示动态方式配置<code>ip</code>，这样就配置完成了，可以直接查看<code>ip</code>：</p>
<figure data-type="image" tabindex="7"><img src="https://img-blog.csdnimg.cn/20201208095834514.png" alt="在这里插入图片描述" loading="lazy"></figure>
<p>如果还是没有<code>ip</code>可以尝试手动连接设备：</p>
<pre><code class="language-bash">nmcli d connect ens33 
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://2293736867.github.io/post/mei-ri-fen-xiang-di-177-qi/">
              <h3 class="post-title">
                下一篇：每日分享 第177期
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">我配不上你，
纵然很努力。</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://2293736867.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
